<!DOCTYPE html>
<html>
	<head>
		<title>SMD for Meteor - Tests</title>
		<script type="text/javascript" src="meteor-smd.js"></script>
		<script type="text/javascript">
			// Inline tests

			(function () {

				var test1 = null;

				console.log("Starting tests...");

				define("TestLocation", ["TestHouse", "TestYardSize"], function (TestHouse, TestYardSize) {
					console.log("5 assertions:");
					console.log(TestHouse.person.age === 33);
					console.log(TestHouse.person.name === "Mathieu");
					console.log(TestHouse.bedrooms === 4);
					console.log(TestHouse.garages === 2);
					console.log(TestYardSize === "small");

					return {
						address: "21 Fake Street",
						house: TestHouse,
						yard: TestYardSize
					}
				});

				using("TestLocation", "TestLaneway", function (TestLocation, TestLaneway) {
					console.log("8 assertions:");
					console.log(TestLocation.address === "21 Fake Street");
					console.log(TestLocation.house.person.age === 33);
					console.log(TestLocation.house.person.name === "Mathieu");
					console.log(TestLocation.house.bedrooms === 4);
					console.log(TestLocation.house.garages === 2);
					console.log(TestLocation.yard === "small");
					console.log(TestLaneway.width === "double");
					console.log(TestLaneway.length === "medium");

					test1 = "test";

					return "ok";
				});

				console.log("1 assertion:");
				console.log(test1 === null);

				define("TestPerson", function () {
					return {
						age: 33,
						name: "Mathieu"
					}
				});

				define("TestHouse", ["TestPerson"], function (TestPerson) {
					console.log("2 assertions:");
					console.log(TestPerson.age === 33);
					console.log(TestPerson.name === "Mathieu");

					return {
						person: TestPerson,
						bedrooms: 4,
						garages: 2
					}
				});

				define("TestYardSize", "small");
				define("TestLaneway", {width: "double", length: "medium"});

				using(["TestPerson", "TestYardSize", "TestLaneway"], function (TestPerson, TestYardSize, TestLaneway) {
					console.log("5 assertions:");
					console.log(TestPerson.age === 33);
					console.log(TestPerson.name === "Mathieu");
					console.log(TestYardSize === "small");
					console.log(TestLaneway.width === "double");
					console.log(TestLaneway.length === "medium");
				});

			})();
		</script>
	</head>
	<body>
		<p>Tests: check the results of console.log</p>
	</body>
</html>